<%- include('partials/header', { pageTitle, theme }) %>
<%- include('partials/nav') %>
<main id="main" class="layout">
  <section class="page-header">
    <h1>Success Log</h1>
    <p>Celebrate the landfalls of Hope Turtles and share new stories.</p>
  </section>

  <section class="success-grid full">
    <% entries.forEach(function (entry) { %>
      <article class="success-card">
        <header>
          <h2>Thank you</h2>
          <span><%= entry.date_found %></span>
        </header>
        <p><%= entry.thank_you_message %></p>
        <footer>
          <span>Coordinates: <%= entry.location_lat %>, <%= entry.location_lng %></span>
          <% if (entry.turtle_name) { %>
            <span>Turtle: <%= entry.turtle_name %></span>
          <% } %>
        </footer>
      </article>
    <% }) %>
  </section>

  <section class="success-form">
    <h2>Submit a new success</h2>
    <form id="successForm" class="form-card" enctype="multipart/form-data">
      <label>
        Turtle
        <select name="turtle_id">
          <option value="">Unknown turtle</option>
          <% turtles.forEach(function (turtle) { %>
            <option value="<%= turtle.turtle_id %>"><%= turtle.name %></option>
          <% }) %>
        </select>
      </label>
      <label>
        Date found
        <input type="date" name="date_found" />
      </label>
      <label>
        Latitude
        <input type="number" step="0.000001" name="location_lat" />
      </label>
      <label>
        Longitude
        <input type="number" step="0.000001" name="location_lng" />
      </label>
      <label>
        Thank you message
        <textarea name="thank_you_message" required></textarea>
      </label>
      <label>
        Photo upload
        <input type="file" name="photo" accept="image/*" />
      </label>
      <button type="submit" class="button">Submit success</button>
      <p id="successFeedback" role="status" aria-live="polite"></p>
    </form>
  </section>
</main>
<% const pageScripts = ['/js/success.js']; %>
<%- include('partials/footer', { pageScripts }) %>
