<% const extraStyles = ['https://unpkg.com/leaflet@1.9.4/dist/leaflet.css']; %>
<%- include('partials/header', { pageTitle, theme, extraStyles }) %>
<%- include('partials/nav') %>
<main id="main" class="layout">
  <section class="page-header">
    <h1>Missions Explorer</h1>
    <p>Filter by status and follow the coordinates each Hope Turtle is aiming for.</p>
    <div class="filters">
      <label>
        Status
        <select id="missionFilter">
          <option value="">All</option>
          <option value="planned">Planned</option>
          <option value="active">Active</option>
          <option value="completed">Completed</option>
        </select>
      </label>
    </div>
  </section>

  <section class="mission-list">
    <% missions.forEach(function (mission) { %>
      <% const statusKey = (mission.status || 'unknown').toLowerCase(); %>
      <% const statusLabel = mission.status ? mission.status.charAt(0).toUpperCase() + mission.status.slice(1) : 'Unknown'; %>
      <article class="card mission-card" id="mission-<%= mission.mission_id %>" data-status="<%= mission.status %>">
        <span class="status-pill status-<%= statusKey %>"><%= statusLabel %></span>
        <header class="card-header">
          <h2><%= mission.name %></h2>
        </header>
        <p><%= mission.description %></p>
        <dl class="mission-meta">
          <div>
            <dt>Coordinates</dt>
            <dd><%= mission.target_lat %>, <%= mission.target_lng %></dd>
          </div>
          <div>
            <dt>Hub</dt>
            <dd><%= mission.hub_name || 'â€”' %></dd>
          </div>
        </dl>
      </article>
    <% }) %>
  </section>

  <%- include('partials/map', { heading: 'Mission Map', description: 'Each marker represents a Hope Turtle objective.' }) %>
</main>
<% const pageScripts = [
  'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js',
  '/js/missions.js'
]; %>
<%- include('partials/footer', { pageScripts }) %>
